<!--
    Form assegnazione articolo a numeri GEKO.

    Partial caricato nel modale via HTMX.
    Permette di selezionare uno o piÃ¹ numeri a cui assegnare l'articolo.
-->
<form
    hx-post="/articles/{{ article.id }}/assign"
    hx-target="#article-{{ article.id }}"
    hx-swap="outerHTML"
    hx-on::after-request="document.getElementById('assign-modal').close()"
>
    <p class="form-help">
        Seleziona i numeri GEKO in cui pubblicare<br>
        <strong>"{{ article.titolo }}"</strong>
    </p>

    <div class="checkbox-list">
        {% for magazine in magazines %}
        <label class="checkbox-item">
            <input
                type="checkbox"
                name="magazine_ids"
                value="{{ magazine.id }}"
                {% if magazine in article.magazines %}checked{% endif %}
            >
            <span class="checkbox-label">
                GEKO {{ magazine.numero }}
                <small>({{ magazine.mese }} {{ magazine.anno }})</small>
                {% if magazine.stato.value == 'pubblicato' %}
                <span class="badge badge-success">Pubblicato</span>
                {% else %}
                <span class="badge badge-outline">Bozza</span>
                {% endif %}
            </span>
        </label>
        {% else %}
        <p class="empty-state">
            Nessun numero GEKO creato.<br>
            <a href="/magazines/new">Crea il primo numero</a>
        </p>
        {% endfor %}
    </div>

    {% if magazines %}
    <div class="form-actions">
        <button type="submit" class="btn btn-primary">Salva assegnazione</button>
        <button type="button" class="btn btn-secondary" onclick="document.getElementById('assign-modal').close()">
            Annulla
        </button>
    </div>
    {% endif %}
</form>
